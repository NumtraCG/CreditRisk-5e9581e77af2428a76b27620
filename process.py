import json
import Connectors
import Transformations
import AutoML
try:
    CreditRisk_DBFS = Connectors.DBFSConnector.fetch(
        [], {}, "5e9581e77af2428a76b27621", spark, "{'url': '/Demo/PredictCreditRisk.csv', 'file_type': 'Delimeted', 'dbfs_token': 'dapib3c8e0614707f7e6d2addea6ce7c33d0', 'dbfs_domain': 'westus.azuredatabricks.net', 'delimiter': ',', 'is_header': 'Use Header Line'}")

except Exception as ex:
    print(ex)
try:
    CreditRisk_AutoFE = Transformations.TransformationMain.run(["5e9581e77af2428a76b27621"], {"5e9581e77af2428a76b27621": CreditRisk_DBFS}, "5e9581e77af2428a76b27622", spark, json.dumps({"FE": [{"transformationsData": {"feature_label": "Status_of_checking_account"}, "feature": "Status_of_checking_account", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A11", "max": "A14", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Duration_in_months", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "20.47", "stddev": "11.74", "min": "4", "max": "60", "missing": "0"}}, {"transformationsData": {"feature_label": "Credit_history"}, "feature": "Credit_history", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A30", "max": "A34", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Purpose"}, "feature": "Purpose", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A40", "max": "A49", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Credit_amount", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "3155.26", "stddev": "2700.91", "min": "250", "max": "15945", "missing": "0"}}, {"transformationsData": {"feature_label": "Savings_account_bond"}, "feature": "Savings_account_bond", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A61", "max": "A65", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Present_employment_since"}, "feature": "Present_employment_since", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A71", "max": "A75", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Installment_rate_in_percentage_of_disposable_income", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "2.99", "stddev": "1.12", "min": "1", "max": "4", "missing": "0"}}, {"transformationsData": {"feature_label": "Personal_status_and_sex"}, "feature": "Personal_status_and_sex", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A91", "max": "A94", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Other_debtors"}, "feature": "Other_debtors", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A101", "max": "A103", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Present_residence_since", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "2.85", "stddev": "1.1", "min": "1", "max": "4", "missing": "0"}}, {"transformationsData": {"feature_label": "Property"}, "feature": "Property", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A121", "max": "A124", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Age_in_years", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "35.79", "stddev": "11.46", "min": "19", "max": "75", "missing": "0"}}, {"transformationsData": {"feature_label": "Other_installment_plans"}, "feature": "Other_installment_plans", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A141", "max": "A143", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Housing"}, "feature": "Housing", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A151", "max": "A153", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Number_of_existing_credits", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {
                                                               "count": "653", "mean": "1.42", "stddev": "0.59", "min": "1", "max": "4", "missing": "0"}}, {"transformationsData": {"feature_label": "Job"}, "feature": "Job", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A171", "max": "A174", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Number_of_people", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "1.15", "stddev": "0.36", "min": "1", "max": "2", "missing": "0"}}, {"transformationsData": {"feature_label": "Telephone"}, "feature": "Telephone", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A191", "max": "A192", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Foreign_worker"}, "feature": "Foreign_worker", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "653", "mean": "", "stddev": "", "min": "A201", "max": "A202", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Credit_Risk", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "653", "mean": "0.72", "stddev": "0.45", "min": "0", "max": "1", "missing": "0"}}, {"feature": "Status_of_checking_account_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.98", "stddev": "0.96", "min": "0", "max": "3", "missing": "0"}}, {"feature": "Credit_history_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "653", "mean": "0.79", "stddev": "1.07", "min": "0.0", "max": "4.0", "missing": "0"}}, {"feature": "Purpose_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "653", "mean": "2.0", "stddev": "2.02", "min": "0.0", "max": "9.0", "missing": "0"}}, {"feature": "Savings_account_bond_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "653", "mean": "0.78", "stddev": "1.17", "min": "0.0", "max": "4.0", "missing": "0"}}, {"feature": "Present_employment_since_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "653", "mean": "1.32", "stddev": "1.25", "min": "0.0", "max": "4.0", "missing": "0"}}, {"feature": "Personal_status_and_sex_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.66", "stddev": "0.86", "min": "0", "max": "3", "missing": "0"}}, {"feature": "Other_debtors_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.14", "stddev": "0.46", "min": "0", "max": "2", "missing": "0"}}, {"feature": "Property_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "1.24", "stddev": "1.07", "min": "0", "max": "3", "missing": "0"}}, {"feature": "Other_installment_plans_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.25", "stddev": "0.54", "min": "0", "max": "2", "missing": "0"}}, {"feature": "Housing_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.4", "stddev": "0.68", "min": "0", "max": "2", "missing": "0"}}, {"feature": "Job_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.56", "stddev": "0.83", "min": "0", "max": "3", "missing": "0"}}, {"feature": "Telephone_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.39", "stddev": "0.49", "min": "0", "max": "1", "missing": "0"}}, {"feature": "Foreign_worker_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "653", "mean": "0.04", "stddev": "0.2", "min": "0", "max": "1", "missing": "0"}}]}))

except Exception as ex:
    print(ex)
try:
    AutoML.functionClassification(CreditRisk_AutoFE, ["Status_of_checking_account", "Duration_in_months", "Credit_history", "Purpose", "Credit_amount", "Savings_account_bond", "Present_employment_since", "Installment_rate_in_percentage_of_disposable_income",
                                                      "Personal_status_and_sex", "Other_debtors", "Present_residence_since", "Property", "Age_in_years", "Other_installment_plans", "Housing", "Number_of_existing_credits", "Job", "Number_of_people", "Telephone", "Foreign_worker"], "Credit_Risk")

except Exception as ex:
    print(ex)
